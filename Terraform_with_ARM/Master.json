{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"Location-of-Virtual_Network1": {
			"type": "string"
		},
		"Virtual_Network1-name": {
			"type": "string",
			"defaultValue": "Vnet-1",
			"metadata": {

				"description": "Name of First Virtual Network"
			}
		},
		"Vnet1addressPrefix": {
			"type": "string",
			"defaultValue": "10.0.0.0/16",
			"metadata": {
				"description": "Adress range for the Virtual_Network1-name."
			}
		},
		"subnet1-name": {
			"type": "string",
			"defaultValue": "subnet-1"

		},
		"subnet1-AddressPrefix": {
			"type": "string",
			"defaultValue": "10.0.1.0/24",
			"metadata": {
				"description": "Address range for first subnet."
			}
		},
		"subnet2-name": {
			"type": "string",
			"defaultValue": "subnet-2"
		},
		"subnet2-AddressPrefix": {
			"type": "string",
			"defaultValue": "10.0.2.0/24",
			"metadata": {
				"description": "Address range for second subnet"
			}
		},
		"subnet3-name": {
			"type": "string",
			"defaultValue": "subnet-3"
		},
		"subnet3-AddressPrefix": {
			"type": "string",
			"defaultValue": "10.0.3.0/24",
			"metadata": {
				"description": "Address range for third subnet"
			}
		},
		"firewallSubnet-AddressPrefix-Vnet1": {
			"type": "string",
			"defaultValue": "10.0.4.0/24",
			"metadata": {
				"description": "Address range for firewall subnet"
			}
		},
		"Management-JumpBox_Subnet_Name": {
			"type": "string",
			"defaultValue": "admin"
		},
		"Management-JumpBox_Subnet_AddressPrefix": {
			"type": "string",
			"defaultValue": "10.0.5.0/24",
			"metadata": {
				"description": "Address range for third subnet"
			}
		},
		"Virtual_Network2-name": {
			"type": "string",
			"defaultValue": "Vnet-2",
			"metadata": {

				"description": "This is the name of the second Vnet to be created."
			}
		},

		"Vnet2addressPrefix": {
			"type": "string",
			"defaultValue": "20.0.0.0/16",
			"metadata": {
				"description": "Address range for the Vnet2."
			}
		},
		"Location-of-Virtual_Network2": {
			"type": "string"
		},

		"subnet1-Name-Vnet2": {
			"type": "string",
			"defaultValue": "subnet-1-replica"

		},
		"subnet1-AddressPrefix-Vnet2": {
			"type": "string",
			"defaultValue": "20.0.1.0/24",
			"metadata": {
				"description": "Address range for first subnet."
			}
		},
		"subnet2-Name-Vnet2": {
			"type": "string",
			"defaultValue": "subnet-2-replica"
		},
		"subnet2-AddressPrefix-Vnet2": {
			"type": "string",
			"defaultValue": "20.0.2.0/24",
			"metadata": {
				"description": "Address range for second subnet"
			}
		},
		"subnet3-Name-Vnet2": {
			"type": "string",
			"defaultValue": "subnet-3-replica"
		},
		"subnet3-AddressPrefix-Vnet2": {
			"type": "string",
			"defaultValue": "20.0.3.0/24",
			"metadata": {
				"description": "Address range for third subnet"
			}
		},

		"firewallSubnet-AddressPrefix-Vnet2": {
			"type": "string",
			"defaultValue": "20.0.4.0/24",
			"metadata": {
				"description": "Address range for firewall subnet"
			}
		},

		"Management-JumpBox_Subnet_Name-Vnet2": {
			"type": "string",
			"defaultValue": "admin-replica"
		},
		"Management-JumpBox_Subnet_AddressPrefix-Vnet2": {
			"type": "string",
			"defaultValue": "20.0.5.0/24",
			"metadata": {
				"description": "Address range for jumbox subnet of Vnet2"
			}
		},
		"NSG1-name": {
			"type": "string",
			"metadata": {
				"description": "Name of first security group"
			}
		},
		"NSG2-name": {
			"type": "string",
			"metadata": {
				"description": "Name of second security group"
			}
		},
		"NSG3-name": {
			"type": "string",
			"metadata": {
				"description": "Name of third security group"
			}
		},
		"NSG1-name-replica": {
			"type": "string",
			"metadata": {
				"description": "Name of first security group"
			}
		},
		"NSG2-name-replica": {
			"type": "string",
			"metadata": {
				"description": "Name of second security group"
			}
		},
		"NSG3-name-replica": {
			"type": "string",
			"metadata": {
				"description": "Name of third security group"
			}
		},
		
		"enableDdosProtection": {
			"type": "bool",
			"defaultValue": false
		},

		"virtual-Network-Access": {
			"type": "bool",
			"defaultValue": true,
			"metadata": {
				"description": "Allow access to the virtual networks."
			}
		},
		"forwarded-Traffic": {
			"type": "bool",
			"defaultValue": false,
			"metadata": {
				"description": "allow traffic forwarded by a network virtual appliance in a virtual network"
			}
		},
		"gateway-Transit": {
			"type": "bool",
			"defaultValue": false,
			"metadata": {
				"description": "If there is a virtual network gateway assosciated with the vnet."
			}
		},
		"remoteGateways": {
			"type": "bool",
			"defaultValue": false,
			"metadata": {
				"description": "To allow traffic from Virtual_Network1-name to Vnet2 through the gateway of Vnet2"
			}
		}

	},

	"resources": [{
			"type": "Microsoft.Resources/deployments",
			"apiVersion": "2018-05-01",
			"name": "LinkedTemplate1",
			"properties": {
				"mode": "Incremental",
				"templateLink": {
					"uri": "https://raw.githubusercontent.com/riyaagrahari/ARM-Templates/master/NestedTemplate_for_DisasterRecovery/CreateNSG.json",
					"contentVersion": "1.0.0.0"
				},
				"parameters": {
					"Location": {
						"value": "[parameters('Location-of-Virtual_Network1')]"
					},
					"NSG1-name": {
						"value": "[parameters('NSG1-name')]"
					},
					"NSG2-name": {
						"value": "[parameters('NSG2-name')]"
					},
					"NSG3-name": {
						"value": "[parameters('NSG3-name')]"
					},
					"subnet1-AddressPrefix": {
						"value": "[parameters('subnet1-AddressPrefix')]"
					},
					"subnet2-AddressPrefix": {
						"value": "[parameters('subnet2-AddressPrefix')]"
					},
					"subnet3-AddressPrefix": {
						"value": "[parameters('subnet3-AddressPrefix')]"
					},
					"subnet1-AddressPrefix-Vnet2": {
						"value": "[parameters('subnet1-AddressPrefix-Vnet2')]"
					},
					"subnet2-AddressPrefix-Vnet2": {
						"value": "[parameters('subnet2-AddressPrefix-Vnet2')]"
					},
					"subnet3-AddressPrefix-Vnet2": {
						"value": "[parameters('subnet3-AddressPrefix-Vnet2')]"
					},

					"Management-JumpBox_Subnet_AddressPrefix": {
						"value": "[parameters('Management-JumpBox_Subnet_AddressPrefix')]"
					},
					"Management-JumpBox_Subnet_AddressPrefix-Vnet2": {
						"value": "[parameters('Management-JumpBox_Subnet_AddressPrefix-Vnet2')]"
					}



				}
			}
		},
		{
			"type": "Microsoft.Resources/deployments",
			"apiVersion": "2018-05-01",
			"name": "LinkedTemplate2",
			"dependsOn": ["LinkedTemplate1"],

			"properties": {
				"mode": "Incremental",
				"templateLink": {
					"uri": "https://raw.githubusercontent.com/riyaagrahari/ARM-Templates/master/NestedTemplate_for_DisasterRecovery/VnetTemplate.json",
					"contentVersion": "1.0.0.0"
				},
				"parameters": {
					"Virtual_Network1-name": {
						"value": "[parameters('Virtual_Network1-name')]"
					},
					"Location": {
						"value": "[parameters('Location-of-Virtual_Network1')]"
					},
					"NSG1-name": {
						"value": "[parameters('NSG1-name')]"
					},
					"NSG2-name": {
						"value": "[parameters('NSG2-name')]"
					},
					"NSG3-name": {
						"value": "[parameters('NSG3-name')]"
					},
					"subnet1-name": {
						"value": "[parameters('subnet1-name')]"
					},
					"subnet2-name": {
						"value": "[parameters('subnet2-name')]"
					},
					"subnet3-name": {
						"value": "[parameters('subnet3-name')]"
					},
					"subnet1-AddressPrefix": {
						"value": "[parameters('subnet1-AddressPrefix')]"
					},
					"subnet2-AddressPrefix": {
						"value": "[parameters('subnet2-AddressPrefix')]"
					},
					"subnet3-AddressPrefix": {
						"value": "[parameters('subnet3-AddressPrefix')]"
					},
					"Vnet1addressPrefix": {
						"value": "[parameters('Vnet1addressPrefix')]"
					},

					"firewallSubnet-AddressPrefix": {
						"value": "[parameters('firewallSubnet-AddressPrefix-Vnet1')]"
					},
					"Management-JumpBox_Subnet_Name": {
						"value": "[parameters('Management-JumpBox_Subnet_Name')]"
					},
					"Management-JumpBox_Subnet_AddressPrefix": {
						"value": "[parameters('Management-JumpBox_Subnet_AddressPrefix')]"
					},
					"enableDdosProtection": {
						"value": "[parameters('enableDdosProtection')]"
					}
				}
			}

		},
		{
			"type": "Microsoft.Resources/deployments",
			"apiVersion": "2018-05-01",
			"name": "LinkedTemplate5",
			"properties": {
				"mode": "Incremental",
				"templateLink": {
					"uri": "https://raw.githubusercontent.com/riyaagrahari/ARM-Templates/master/NestedTemplate_for_DisasterRecovery/CreateNSG.json",
					"contentVersion": "1.0.0.0"
				},
				"parameters": {
					"Location": {
						"value": "[parameters('Location-of-Virtual_Network2')]"
					},
					"NSG1-name": {
						"value": "[parameters('NSG1-name-replica')]"
					},
					"NSG2-name": {
						"value": "[parameters('NSG2-name-replica')]"
					},
					"NSG3-name": {
						"value": "[parameters('NSG3-name-replica')]"
					},
					"subnet1-AddressPrefix": {
						"value": "[parameters('subnet1-AddressPrefix')]"
					},
					"subnet2-AddressPrefix": {
						"value": "[parameters('subnet2-AddressPrefix')]"
					},
					"subnet3-AddressPrefix": {
						"value": "[parameters('subnet3-AddressPrefix')]"
					},
					"subnet1-AddressPrefix-Vnet2": {
						"value": "[parameters('subnet1-AddressPrefix-Vnet2')]"
					},
					"subnet2-AddressPrefix-Vnet2": {
						"value": "[parameters('subnet2-AddressPrefix-Vnet2')]"
					},
					"subnet3-AddressPrefix-Vnet2": {
						"value": "[parameters('subnet3-AddressPrefix-Vnet2')]"
					},

					"Management-JumpBox_Subnet_AddressPrefix": {
						"value": "[parameters('Management-JumpBox_Subnet_AddressPrefix')]"
					},
					"Management-JumpBox_Subnet_AddressPrefix-Vnet2": {
						"value": "[parameters('Management-JumpBox_Subnet_AddressPrefix-Vnet2')]"
					}



				}
			}
		},

		{
			"type": "Microsoft.Resources/deployments",
			"apiVersion": "2018-05-01",
			"name": "LinkedTemplate3",
			"dependsOn": ["LinkedTemplate1","LinkedTemplate5"],
			"properties": {
				"mode": "Incremental",
				"templateLink": {
					"uri": "https://raw.githubusercontent.com/riyaagrahari/ARM-Templates/master/NestedTemplate_for_DisasterRecovery/VnetTemplate.json",
					"contentVersion": "1.0.0.0"
				},
				"parameters": {
					"Virtual_Network1-name": {
						"value": "[parameters('Virtual_Network2-name')]"
					},
					"Vnet1addressPrefix": {
						"value": "[parameters('Vnet2addressPrefix')]"
					},
					"Location": {
						"value": "[parameters('Location-of-Virtual_Network2')]"
					},
					"subnet1-Name": {
						"value": "[parameters('subnet1-Name-Vnet2')]"
					},
					"subnet2-Name": {
						"value": "[parameters('subnet2-Name-Vnet2')]"
					},
					"subnet3-Name": {
						"value": "[parameters('subnet3-Name-Vnet2')]"
					},
					"NSG1-name": {
						"value": "[parameters('NSG1-name-replica')]"
					},
					"NSG2-name": {
						"value": "[parameters('NSG2-name-replica')]"
					},
					"NSG3-name": {
						"value": "[parameters('NSG3-name-replica')]"
					},
					"subnet1-AddressPrefix": {
						"value": "[parameters('subnet1-AddressPrefix-Vnet2')]"
					},
					"subnet2-AddressPrefix": {
						"value": "[parameters('subnet2-AddressPrefix-Vnet2')]"
					},
					"subnet3-AddressPrefix": {
						"value": "[parameters('subnet3-AddressPrefix-Vnet2')]"
					},
					"firewallSubnet-AddressPrefix": {
						"value": "[parameters('firewallSubnet-AddressPrefix-Vnet2')]"
					},
					"Management-JumpBox_Subnet_Name": {
						"value": "[parameters('Management-JumpBox_Subnet_Name-Vnet2')]"
					},
					"Management-JumpBox_Subnet_AddressPrefix": {
						"value": "[parameters('Management-JumpBox_Subnet_AddressPrefix-Vnet2')]"
					},
					"enableDdosProtection": {
						"value": "[parameters('enableDdosProtection')]"
					}

				}
			}
		},
		{
			"type": "Microsoft.Resources/deployments",
			"apiVersion": "2018-05-01",
			"name": "LinkedTemplate4",
			"dependsOn": ["LinkedTemplate3", "LinkedTemplate2"],
			"properties": {
				"mode": "Incremental",
				"templateLink": {
					"uri": "https://raw.githubusercontent.com/riyaagrahari/ARM-Templates/master/Vnet_Peering_Template/Template.json",
					"contentVersion": "1.0.0.0"
				},
				"parameters": {
					"Virtual_Network1_name": {
						"value": "[parameters('Virtual_Network1-name')]"
					},
					"Virtual_Network2_name": {
						"value": "[parameters('Virtual_Network2-name')]"
					},
					"Allow_Virtual_Network_Access": {
						"value": "[parameters('virtual-Network-Access')]"
					},
					"Allow_Forwarded_Traffic": {
						"value": "[parameters('forwarded-Traffic')]"
					},
					"Allow_Gateway_Transit": {
						"value": "[parameters('gateway-Transit')]"
					},
					"Use_Remote_Gateways": {
						"value": "[parameters('remoteGateways')]"
					}

				}
			}
		}
	]
}